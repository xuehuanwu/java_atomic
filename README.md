1、CAS是什么？ ==> compareAndSet 比较并交换
它是一条CPU并发原语。
它的功能是判断内存某个位置是否为预期值，如果是则更新为新的值，这个过程是原子性的。

2、CAS底层原理
1、rt.jar --> sun.misc.Unsafe
内部源码 unsafe类
unsafe类是CAS的核心类，由于java方法无法直接访问底层系统，需要通过本地(native)方法来访问
unsafe相当于一个后门，基于该类可以直接操作特定内存的数据。
注意unsafe类中的所有方法都是native修饰的，也就是说unsafe类中的方法都直接调用操作系统底层资源执行相应任务
2、自旋 --> 底层用do while

3、CAS缺点
1、循环时间长开销很大
2、只能保证一个共享变量的原子操作
3、引出来ABA问题 --> 狸猫换太子
CAS会导致“ABA问题”
CAS算法实现一个重要前提需要提取内存中某时刻的数据并在当下时刻比较并替换，那么在这个时间差类会导致数据的变化。
例子：线程1从内存位置V中取出A，这时候线程2也从内存中取出A，并且线程2进行了一些操作将值变成了B，然后线程2又将V位置的数据变成A，
这时候线程1进行CAS操作发现内存中仍然是A，然后线程1操作成功。
注意：尽管线程1的CAS操作成功，但不代表这个过程就是没有问题的。
解决ABA问题
原子引用 + 新增一种机制，那就是修改版本号(类似时间戳)

4、CAS应用
CAS有3个操作数，内存值V，旧的预期值A，要修改的更新值B，当且仅当预期值A和内存值V相同时，将内存值V修改为B，否则继续循环比较，直到成功为止。
